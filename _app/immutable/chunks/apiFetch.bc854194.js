import{a as r}from"./loadingStore.store.cd0289c0.js";import{g as n}from"./scheduler.7a7c0b35.js";import{j as l}from"./singletons.26ed263e.js";const h="https://webchat5400.azurewebsites.net/api",f=l("goto");async function c(){var o,a;let t;t=await fetch(h+"/auth/refresh",{headers:{"Content-Type":"application/json",Accept:"application/json","Access-Control-Allow-Origin":"*",Authorization:`Bearer ${(o=n(r))==null?void 0:o.accessToken}`},body:JSON.stringify({refreshToken:(a=n(r))==null?void 0:a.refreshToken}),method:"POST"}),t.ok||(r.set(null),f("/"));const e=await t.json(),s=n(r);r.set({accessToken:e.accessToken,refreshToken:e.refreshToken,email:s.email,id:s.id})}async function i(t,e={},s=!0){var o;e={...e,headers:{...e.headers,"Content-Type":"application/json",Accept:"application/json","Access-Control-Allow-Origin":"*",Authorization:`Bearer ${(o=n(r))==null?void 0:o.accessToken}`}};try{const a=await fetch(h+t,e);return a.status===401&&s?(await c(),i(t,e,!1)):a}catch(a){if(!s)throw a;return await c(),i(t,e,!1)}}export{h as P,i as a,f as g,c as r};
